#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "üîê V√©rification des secrets avec Gitleaks..."

# Utiliser gitleaks via node_modules
if [ -f "node_modules/.bin/gitleaks" ]; then
  ./node_modules/.bin/gitleaks protect --staged --verbose
  if [ $? -ne 0 ]; then
    echo "‚ùå Erreur : Des secrets potentiels ont √©t√© d√©tect√©s !"
    echo "‚ö†Ô∏è  Veuillez supprimer les secrets avant de committer"
    exit 1
  fi
  echo "‚úÖ Aucun secret d√©tect√©"
else
  echo "‚ö†Ô∏è  Gitleaks non trouv√©, v√©rification ignor√©e"
fi
